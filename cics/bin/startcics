#!/bin/sh
#
# cics: start or stop a CICS server
#
# msf: ADCD system does not have DFHTEMP, DFHDMPA, DFHDMPB, DFHAUXT, DFHBUXT, DFHLRQ, DFHINTRA, DFHLCD, DFHGCD datasets as ${DFH_REGION} but just CICS
# 
# msf: ADCD system does not DFHDBFK dataset
# msf: Had to:
# alu ibmuser omvs(noassizemax)
#-and-
#alu ibmuser omvs(memlimit(16G))
#
#because CICS needs at least 6GB above the bar and the default ADCD configuration only provides 2GB
#
#set -x

CEE="${CEE_HLQ}.SCEERUN2:${CEE_HLQ}.SCEERUN"

STEPLIB="--STEPLIB=${DFH_HLQ}.CICS.SDFHAUTH:${DFH_HLQ}.CPSM.SEYUAUTH:${CEE}:${DFH_HLQ}.CICS.SDFHLINK:${DFH_HLQ}.SDFHLIC"
DFHRPL="--DFHRPL=${DFH_HLQ}.CICS.SDFHLOAD:${DFH_HLQ}.CPSM.SEYULOAD:${CEE_HLQ}.SCEECICS:${CEE}:${SEZ_HLQ}.SEZATCP"
DFHCSD="--DFHCSD=${DFH_HLQ}.CICS.DFHCSD"
DFHCMACD="--DFHCMACD=${DFH_HLQ}.DFHCMACD"
DFHDBFK="--DFHDBFK=${DFH_HLQ}.CICS.DFHDBFK"

DFHTEMP="--DFHTEMP=${DFH_HLQ}.CNTL.${DFH_GENERAL}.DFHTEMP"
DFHINTRA="--DFHINTRA=${DFH_HLQ}.CNTL.${DFH_GENERAL}.DFHINTRA"
DFHAUXT="--DFHAUXT=${DFH_HLQ}.${DFH_GENERAL}.DFHAUXT"
DFHBUXT="--DFHBUXT=${DFH_HLQ}.${DFH_GENERAL}.DFHBUXT"
DFHLCD="--DFHLCD=${DFH_HLQ}.${DFH_GENERAL}.DFHLCD"
DFHGCD="--DFHGCD=${DFH_HLQ}.${DFH_GENERAL}.DFHGCD"
DFHDMPA="--DFHDMPDA=${DFH_HLQ}.${DFH_GENERAL}.DFHDMPA"
DFHDMPB="--DFHDMPDB=${DFH_HLQ}.${DFH_GENERAL}.DFHDMPB"
DFHLRQ="--DFHLRQ=${DFH_HLQ}.${DFH_GENERAL}.DFHLRQ"

DFHCXRF="--DFHCXRF=*"
LOGUSR="--LOGUSR=*"
MSGUSR="--MSGUSR=*"
TCPDATA="--TCPDATA=*"
SYSTCPT="--SYSTCPT=*"
SYSTCPD="--SYSTCPD=*"
CEEMSG="--CEEMSG=*"
CEEOUT="--CEEOUT=*"
SYSPRINT="--SYSPRINT=*"
PRINTER="--PRINTER=*"

SYSABEND="--SYSABEND=*"

SYSIN=`dcat "${DFH_HLQ}.SYSIN(DFH\\$SIP1)"`
echo "${SYSIN}"

echo "${SYSIN}" | mvscmdauth --pgm=DFHSIP --args="START=INITIAL,SYSIN" --SYSIN=stdin \
  "${STEPLIB}" "${DFHRPL}" "${DFHCSD}" "${DFHCMACD}" "${DFHDBFK}" "${DFHLRQ}" \
  "${DFHTEMP}" "${DFHAUXT}" "${DFHBUXT}" "${DFHLCD}" "${DFHGCD}" "${DFHINTRA}" \
  "${DFHCXRF}" "${LOGUSR}" "${MSGUSR}" "${TCPDATA}" "${SYSTCPT}" "${SYSTCPD}" "${CEEMSG}" "${CEEOUT}" \
  "${DFHDMPA}" "${DFHDMPB}" "${SYSABEND}" "${SYSPRINT}" "${PRINTER}"  

